(function(){function e(e){var t=curtop=0;if("getBoundingClientRect"in document.documentElement&&!window.opera){var n=e.getBoundingClientRect();var r=e.ownerDocument;var i=r.body;var s=r.documentElement;var o=s.clientTop||i.clientTop||0;var u=s.clientLeft||i.clientLeft||0;curtop=n.top+(window.pageYOffset||s.scrollTop||i.scrollTop)-o;t=n.left+(window.pageXOffset||s.scrollLeft||i.scrollLeft)-u}else{if(e.offsetParent){do{t+=e.offsetLeft;curtop+=e.offsetTop}while(e=e.offsetParent)}}return{left:t,top:curtop}}function t(e){var t=curh=0;e.style.display="block";e.style.visibility="hidden";t=parseInt(e.offsetWidth);curh=parseInt(e.offsetHeight);e.style.display="none";e.style.visibility="";return{width:t,height:curh}}function n(e){var t=Raphael.getRGB(e);var n=parseInt(t.r)-36;var r=parseInt(t.g)-30;var s=parseInt(t.b)-24;return"#"+i(n)+i(r)+i(s)}function r(e){var t=Raphael.getRGB(e);var n=parseInt(t.r)+36;var r=parseInt(t.g)+30;var s=parseInt(t.b)+24;return"#"+i(n)+i(r)+i(s)}function i(e){if(e==null)return"00";e=parseInt(e);if(e==0||isNaN(e))return"00";e=Math.max(0,e);e=Math.min(e,255);e=Math.round(e);return"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)}Raphael.fn.pie=function(i,o,u,a,f,l){function m(){this.side1="";this.side2="";this.border="";this.top="";this.tx=0;this.ty=0;this.txm=0;this.tym=0;this.alphaM=0}function g(){this.paths=[];this.params=[];this.indexes=[]}function B(e,t){for(var n=e.paths.length-1;n>=0;n--){s=v[e.indexes[n]];if(t=="side1"){s[t]=R(e.paths[n],e.params[n])}else{s[t]=U(e.paths[n],e.params[n])}v[e.indexes[n]]=s}}function j(e,t,n,r){e.paths.push(t);e.params.push(n);e.indexes.push(r)}function F(e,t){return["M",e,t,"L",d.cx,d.cy,"L",d.cx,d.cy+d.size3d,"L",e,t+d.size3d,"z"].join(",")}function I(e,t,n,r,i){return["M",e,t,"A",d.R1,d.R2,"0",i,"0",n,r,"L",n,r+d.size3d,"A",d.R1,d.R2,"0",i,"1",e,t+d.size3d,"L",e,t,"z"].join(",")}function q(e,t,n,r,i){return["M",d.cx,d.cy,"L",e,t,"A",d.R1,d.R2,"0",i,"0",n,r,"L",d.cx,d.cy,"z"].join(",")}function R(e,t){part=U(e,t);part.toBack();return part}function U(e,t){part=c.path(e);part.attr(t);return part}function $(n,r){var i=document.getElementById("tooltip");if(r){var s=v[n];var o=Math.round(d.val[n]/d.total*100)+"%";var u=d.labels[n]?d.labels[n]+" - ":"";u=u+o;var a=e(c.canvas);a.left=a.left+d.cx-d.R1;a.top=a.top+d.cy-d.R2;var f=t(i);var l=d.cx-s.txm;var h=l<0?0:f.width+5;var p=a.left+Math.round(d.R1-l)-h;var m=d.cy-s.tym;var g=m<0?0:f.height+5;var y=a.top+Math.round(d.R2-m)-g;i.style.borderColor=d.colors[n];i.innerHTML=u;i.style.left=p+"px";i.style.top=y+"px";i.style.display="block"}else{i.style.display="none"}}function J(e){e.top.attr("fill","90-"+d.lightColors[e.top.num]+"-"+d.colors[e.top.num])}function K(e){e.top.attr("fill","180-"+d.darkColors[e.top.num]+"-"+d.lightColors[e.top.num])}function Q(e,t){var n=e.tx-d.cx;var r=e.ty-d.cy;Y(e,n,r,t)}function G(e,t){e.top.stop();if(e.side1)e.side1.stop();if(e.side2)e.side2.stop();if(e.border)e.border.stop();Y(e,0,0,t)}function Y(e,t,n,r){var i=Raphael.animation({transform:"T"+t+","+n},r);if(e.side1){e.top.animate(i);e.side1.animateWith(e.top,i,i);if(e.side2)e.side2.animateWith(e.top,i,i);if(e.border)e.border.animateWith(e.top,i,i)}else{e.top.animate(i)}}function Z(e){var t=e.tx-d.cx;var n=e.ty-d.cy;e.s1?e.s1.transform("T"+t+","+n):false;e.s2?e.s2.transform("T"+t+","+n):false;e.s3?e.s3.transform("T"+t+","+n):false;e.top.transform("T"+t+","+n)}function et(n,r,i,s){var o=document.createElement("div");o.style.position="absolute";o.style.zIndex=1e3;o.className=d.legendTipCssClass;var u=document.createTextNode(d.labels[r]);o.appendChild(u);i.appendChild(o);var a=document.createElement("li");a.className=d.legendLabelCssClass;var f=document.createElement("span");f.appendChild(document.createTextNode(" "+d.labels[r]));a.appendChild(f);s.appendChild(a);var l=t(a);a.style.display="block";l.height=l.height-1;var h=Raphael(a,l.height,l.height);h.circle(l.height/2,l.height/2,l.height/2).attr({stroke:"none",fill:"180-"+d.darkColors[r]+"-"+d.lightColors[r]});h.canvas.style.top="1px";h.canvas.style.display="inline";h.canvas.style.zoom="1";h.canvas.style.overflow="visible";var p=e(c.canvas);var v=t(o);var m=d.cx-n.txm;var g=m<0?-5:v.width+5;var y=d.cy-n.tym;var b=y<0?0:v.height+5;var w=d.cx+(d.R1+20)*Math.cos(n.alphaM*Math.PI/180);var E=d.cy+(d.R2+20)*Math.sin(n.alphaM*Math.PI/180);var S=["M",n.txm,n.tym,"L",w,E].join(",");U(S,{stroke:d.legendTipLineColor});c.circle(w,E,3).attr({stroke:"none",fill:d.legendTipLineColor});o.style.left=Math.round(p.left+w-g)+"px";o.style.top=Math.round(p.top+E-b)+"px";o.style.display="block"}function tt(e,t){return t*e<180?0:1}function nt(){Raphael.getColor.reset();for(var e=0;e<d.numberOfValues;e++){d.total+=d.val[e];d.colors[e]===undefined?d.colors[e]=Raphael.getColor():false;d.darkColors[e]=n(d.colors[e]);d.lightColors[e]=r(d.colors[e])}}var c=this;var h=this.canvas.parentElement;l=l||{};var d={cx:i/2,cy:o/2,R1:u,R2:a,val:f,numberOfValues:f.length,total:0,colors:l.colors||[],darkColors:[],lightColors:[],show3d:l.show3d||false,size3d:l.size3d||15,animation:l.animation||false,explode:l.explode||false,tooltip:l.tooltip||false,labels:l.labels||[],backgroundFill:l.backgroundFill||["#fff","#fff"],legendTipLineColor:l.legendTipLineColor||"#000",legendTipCssClass:l.legendTipCssClass||"raphael-charts-legend-tip",legendContainerCssClass:l.legendContainerCssClass||"raphael-charts-legend-container",legendLabelCssClass:l.legendLabelCssClass||"raphael-charts-legend-label"};var v=[];nt();var y=4;var b=360/d.total;var w=Math.PI/180;var E=0;var S=true;var x=new g;var T=new g;var N=new g;var C=d.cx+d.R1;var k=d.cy;if(!d.show3d){d.R2=d.R1;y=8}if(d.numberOfValues==1){s=new m;var L=c.ellipse(d.cx,d.cy,d.R1,d.R2);L.attr({stroke:"none",fill:d.colors[0]});s.top=L;if(d.show3d){p=I(d.cx-d.R1,d.cy,d.cx+d.R1,d.cy,0);borderParams={stroke:"none",fill:"90-"+d.darkColors[0]+"-"+d.colors[0]};s.border=U(p,borderParams)}v[0]=s}else{for(var A=0;A<d.numberOfValues;A++){s=new m;sideParams={stroke:"none",fill:d.darkColors[A]};borderParams={stroke:"none",fill:"90-"+d.darkColors[A]+"-"+d.colors[A]};topParams={stroke:"#ccc",fill:"180-"+d.darkColors[A]+"-"+d.lightColors[A]};var O=C;var M=k;E+=d.val[A];alpha=b*E;var _=tt(d.val[A],b);C=d.cx+d.R1*Math.cos(alpha*w);k=d.cy+d.R2*Math.sin(alpha*w);alphaM=b*(E-d.val[A]/2);x4=d.cx+d.R1/y*Math.cos(alphaM*w);y4=d.cy+d.R2/y*Math.sin(alphaM*w);xm=d.cx+d.R1*Math.cos(alphaM*w);ym=d.cy+d.R2*Math.sin(alphaM*w);s.tx=x4;s.ty=y4;s.txm=xm;s.tym=ym;s.alphaM=alphaM;if(d.show3d){topParams.stroke="none";var D=F(O,M);var P=F(C,k);if(alpha>=90&&alpha<=270){s.side1=R(D,sideParams)}else{if(alpha>180&&alpha<=360){if(b*(E-d.val[A])<270){s.side2=R(D,sideParams)}}if(alpha<90){s.side1=U(P,sideParams)}else{j(T,P,sideParams,A)}}if(S){var H=I(C,k,O,M,_);if(alpha<=90){s.border=U(H,borderParams)}else{if(alpha>=180){H=I(d.cx-d.R1,d.cy,O,M,0);s.border=U(H,borderParams);S=false}else{j(x,H,borderParams,A)}}}}topPath=q(C,k,O,M,_);j(N,topPath,topParams,A);v[A]=s}B(T,"side1");B(x,"border");B(N,"top")}var z=c.rect(0,0,i,o);var W=d.backgroundFill[0]==d.backgroundFill[1]?{stroke:"none",fill:d.backgroundFill[0]}:{stroke:"none",fill:"90-"+d.backgroundFill[0]+"-"+d.backgroundFill[1]};z.attr(W);z.toBack();if(d.animation&&d.numberOfValues>1){for(var A=0;A<d.numberOfValues;A++){v[A].top.num=A;v[A].top.mouseover(function(){if(d.tooltip)$(this.num,true);J(v[this.num]);Q(v[this.num],1e3)}).mouseout(function(){if(d.tooltip)$(this.num,false);K(v[this.num]);G(v[this.num],500)})}}if(d.explode&&!d.animation){for(var A=0;A<d.numberOfValues;A++){Z(v[A])}}if(!d.explode&&!d.animation){var X=document.createElement("div");var V=document.createElement("ul");V.className=d.legendContainerCssClass;h.appendChild(X);h.appendChild(V);for(var A=0;A<d.numberOfValues;A++){et(v[A],A,X,V)}}};Raphael.fn.bar=function(i,s,o,u){function E(e,t,n,r){return["M",e,t,"L",e+f.size3d,t-f.size3d,"L",e+n+f.size3d,t-f.size3d,"L",e+n,t,"z"].join(",")}function S(e,t,n,r){return["M",e+n+f.size3d,t-f.size3d,"L",e+n+f.size3d,t+r-f.size3d,"L",e+n,t+r,"L",e+n,t,"z"].join(",")}function x(e,t){var n=a.path(e);n.attr(t)}function T(e){e.attr("fill",m+"-"+f.darkColors[e.num]+"-"+f.lightColors[e.num])}function N(e){e.attr("fill",m+"-"+f.darkColors[e.num]+"-"+f.colors[e.num])}function C(n,r){var i=document.getElementById("tooltip");if(r){b=l[n];lbl=f.labels[n]?f.labels[n]+" - ":"";lbl=lbl+f.val[n];i.style.borderColor=f.colors[n];i.innerHTML=lbl;cur=e(a.canvas);wh=t(i);var s=yt=0;if(f.horizontal){s=cur.left+b.attr("x")+f.size3d/2+b.attr("width");yt=cur.top+b.attr("y")+b.attr("height")/2-wh.height/2}else{s=cur.left+b.attr("x")+f.size3d/2+b.attr("width")/2-wh.width/2;yt=cur.top+b.attr("y")-f.size3d/2-wh.height}i.style.left=s+"px";i.style.top=yt+"px";i.style.display="block"}else{i.style.display="none"}}function M(){Raphael.getColor.reset();for(var e=0;e<f.numberOfValues;e++){if(f.val[e]>f.max){f.max=f.val[e]}f.colors[e]===undefined?f.colors[e]=Raphael.getColor():false;f.darkColors[e]=n(f.colors[e]);f.lightColors[e]=r(f.colors[e])}}var a=this;u=u||{};var f={val:o,numberOfValues:o.length,max:0,colors:u.colors||[],darkColors:[],lightColors:[],show3d:u.show3d||false,size3d:u.size3d||-1,horizontal:u.horizontal||false,tooltip:u.tooltip||false,labels:u.labels||[],backgroundFill:u.backgroundFill||["#fff","#fff"]};var l=[];M();var c=5;var p=0;var d=0;var v=y=w=h=0;var m=180;if(f.horizontal){m=90;p=(s-c*2)/f.numberOfValues;if(f.size3d==-1)f.size3d=p/4;d=i-f.size3d-c*3;y=c+f.size3d;v=c;h=p/1.5}else{p=(i-c*2)/f.numberOfValues;if(f.size3d==-1)f.size3d=p/4;d=s-f.size3d-c*2;v=c;w=p/1.5}for(var g=0;g<f.numberOfValues;g++){topParams={stroke:"#000","stroke-width":.5,fill:f.colors[g]};sideParams={stroke:"#000","stroke-width":.5,fill:f.darkColors[g]};frontParams={stroke:"#000","stroke-width":.5,fill:m+"-"+f.darkColors[g]+"-"+f.colors[g]};if(f.horizontal){w=d/f.max*f.val[g]}else{h=d/f.max*f.val[g];y=c+d-h+f.size3d}frontPart=a.rect(v,y,w,h);frontPart.attr(frontParams);l[g]=frontPart;l[g].num=g;if(f.tooltip){l[g].mouseover(function(){T(this);C(this.num,true)}).mouseout(function(){N(this);C(this.num,false)})}if(f.show3d){topPath=E(v,y,w,h);x(topPath,topParams);sidePath=S(v,y,w,h);x(sidePath,sideParams)}f.horizontal?y+=p:v+=p}if(f.backgroundFill[0]!=f.backgroundFill[1]){attrGrid={stroke:"none",fill:"45-"+f.backgroundFill[0]+"-"+f.backgroundFill[1]};p3=["M",0,c+f.size3d,"L",c+f.size3d,0,"L",c+f.size3d,s-f.size3d-c,"L",0,s,"z"].join(",");var k=a.path(p3);k.attr(attrGrid);k.toBack();p3=["M",c+f.size3d,0,"L",i,0,"L",i,s-f.size3d-c,"L",c+f.size3d,s-f.size3d-c,"z"].join(",");var L=a.path(p3);L.attr(attrGrid);L.toBack();p3=["M",c+f.size3d,s-f.size3d-c,"L",i,s-f.size3d-c,"L",i-c-f.size3d-1,s,"L",0,s,"z"].join(",");var A=a.path(p3);A.attr(attrGrid);A.toBack()}else{var O=a.rect(0,0,i,s);O.attr({stroke:"none",fill:f.backgroundFill[0]});O.toBack()}}})()