(function(){function e(e){var t=curtop=0;if("getBoundingClientRect"in document.documentElement&&!window.opera){var n=e.getBoundingClientRect();var r=e.ownerDocument;var i=r.body;var s=r.documentElement;var o=s.clientTop||i.clientTop||0;var u=s.clientLeft||i.clientLeft||0;curtop=n.top+(window.pageYOffset||s.scrollTop||i.scrollTop)-o;t=n.left+(window.pageXOffset||s.scrollLeft||i.scrollLeft)-u}else{if(e.offsetParent){do{t+=e.offsetLeft;curtop+=e.offsetTop}while(e=e.offsetParent)}}return{left:t,top:curtop}}function t(e){var t=curh=0;e.style.display="block";e.style.visibility="hidden";t=parseInt(e.offsetWidth);curh=parseInt(e.offsetHeight);e.style.display="none";e.style.visibility="";return{width:t,height:curh}}function n(e){var t=Raphael.getRGB(e);var n=parseInt(t.r)-36;var r=parseInt(t.g)-30;var s=parseInt(t.b)-24;return"#"+i(n)+i(r)+i(s)}function r(e){var t=Raphael.getRGB(e);var n=parseInt(t.r)+36;var r=parseInt(t.g)+30;var s=parseInt(t.b)+24;return"#"+i(n)+i(r)+i(s)}function i(e){if(e==null)return"00";e=parseInt(e);if(e==0||isNaN(e))return"00";e=Math.max(0,e);e=Math.min(e,255);e=Math.round(e);return"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)}Raphael.fn.pie=function(i,o,u,a,f,l){function v(){this.side1="";this.side2="";this.border="";this.top="";this.tx=0;this.ty=0;this.txm=0;this.tym=0}function m(){this.paths=[];this.params=[];this.indexes=[]}function H(e,t){for(var n=e.paths.length-1;n>=0;n--){s=d[e.indexes[n]];if(t=="side1"){s[t]=q(e.paths[n],e.params[n])}else{s[t]=R(e.paths[n],e.params[n])}d[e.indexes[n]]=s}}function B(e,t,n,r){e.paths.push(t);e.params.push(n);e.indexes.push(r)}function j(e,t){return["M",e,t,"L",h.cx,h.cy,"L",h.cx,h.cy+h.size3d,"L",e,t+h.size3d,"z"].join(",")}function F(e,t,n,r,i){return["M",e,t,"A",h.R1,h.R2,"0",i,"0",n,r,"L",n,r+h.size3d,"A",h.R1,h.R2,"0",i,"1",e,t+h.size3d,"L",e,t,"z"].join(",")}function I(e,t,n,r,i){return["M",h.cx,h.cy,"L",e,t,"A",h.R1,h.R2,"0",i,"0",n,r,"L",h.cx,h.cy,"z"].join(",")}function q(e,t){part=R(e,t);part.toBack();return part}function R(e,t){part=c.path(e);part.attr(t);return part}function W(n,r){var i=document.getElementById("tooltip");if(r){var s=d[n];var o=Math.round(h.val[n]/h.total*100)+"%";var u=h.labels[n]?h.labels[n]+" - ":"";u=u+o;var a=e(c.canvas);a.left=a.left+h.cx-h.R1;a.top=a.top+h.cy-h.R2;var f=t(i);var l=h.cx-s.txm;var p=l<0?0:f.width+5;var v=a.left+Math.round(h.R1-l)-p;var m=h.cy-s.tym;var g=m<0?0:f.height+5;var y=a.top+Math.round(h.R2-m)-g;i.style.borderColor=h.colors[n];i.innerHTML=u;i.style.left=v+"px";i.style.top=y+"px";i.style.display="block"}else{i.style.display="none"}}function X(e){e.top.attr("gradient","90-"+h.lightColors[e.top.num]+"-"+h.colors[e.top.num])}function V(e){e.top.attr("gradient","180-"+h.darkColors[e.top.num]+"-"+h.lightColors[e.top.num])}function $(e,t){var n=e.tx-h.cx;var r=e.ty-h.cy;K(e,n,r,t)}function J(e,t){e.top.stop();if(e.side1)e.side1.stop();if(e.side2)e.side2.stop();if(e.border)e.border.stop();K(e,0,0,t)}function K(e,t,n,r){var i=Raphael.animation({transform:"T"+t+","+n},r);if(e.side1){e.top.animate(i);e.side1.animateWith(e.top,i,i);if(e.side2)e.side2.animateWith(e.top,i,i);if(e.border)e.border.animateWith(e.top,i,i)}else{e.top.animate(i)}}function Q(e){var t=e.tx-h.cx;var n=e.ty-h.cy;e.s1?e.s1.transform("T"+t+","+n):false;e.s2?e.s2.transform("T"+t+","+n):false;e.s3?e.s3.transform("T"+t+","+n):false;e.top.transform("T"+t+","+n)}function G(e,t){return t*e<180?0:1}function Y(){Raphael.getColor.reset();for(var e=0;e<h.numberOfValues;e++){h.total+=h.val[e];h.colors[e]===undefined?h.colors[e]=Raphael.getColor():false;h.darkColors[e]=n(h.colors[e]);h.lightColors[e]=r(h.colors[e])}}var c=this;l=l||{};var h={cx:i/2,cy:o/2,R1:u,R2:a,val:f,numberOfValues:f.length,total:0,colors:l.colors||[],darkColors:[],lightColors:[],show3d:l.show3d||false,size3d:l.size3d||15,animation:l.animation||false,explode:l.explode||false,tooltip:l.tooltip||false,labels:l.labels||[],backgroundFill:l.backgroundFill||["#fff","#fff"]};var d=[];Y();var g=4;var y=360/h.total;var b=Math.PI/180;var w=0;var E=true;var S=new m;var x=new m;var T=new m;var N=h.cx+h.R1;var C=h.cy;if(!h.show3d){h.R2=h.R1;g=8}if(h.numberOfValues==1){s=new v;var k=c.ellipse(h.cx,h.cy,h.R1,h.R2);k.attr({stroke:"none",fill:h.colors[0]});s.top=k;if(h.show3d){p=F(h.cx-h.R1,h.cy,h.cx+h.R1,h.cy,0);borderParams={stroke:"none",gradient:"90-"+h.darkColors[0]+"-"+h.colors[0]};s.border=R(p,borderParams)}d[0]=s}else{for(var L=0;L<h.numberOfValues;L++){s=new v;sideParams={stroke:"none",fill:h.darkColors[L]};borderParams={stroke:"none",gradient:"90-"+h.darkColors[L]+"-"+h.colors[L]};topParams={stroke:"#ccc",gradient:"180-"+h.darkColors[L]+"-"+h.lightColors[L]};var A=N;var O=C;w+=h.val[L];alpha=y*w;var M=G(h.val[L],y);N=h.cx+h.R1*Math.cos(alpha*b);C=h.cy+h.R2*Math.sin(alpha*b);alphaM=y*(w-h.val[L]/2);x4=h.cx+h.R1/g*Math.cos(alphaM*b);y4=h.cy+h.R2/g*Math.sin(alphaM*b);xm=h.cx+h.R1*Math.cos(alphaM*b);ym=h.cy+h.R2*Math.sin(alphaM*b);s.tx=x4;s.ty=y4;s.txm=xm;s.tym=ym;if(h.show3d){topParams.stroke="none";var _=j(A,O);var D=j(N,C);if(alpha>=90&&alpha<=270){s.side1=q(_,sideParams)}else{if(alpha>180&&alpha<=360){if(y*(w-h.val[L])<270){s.side2=q(_,sideParams)}}if(alpha<90){s.side1=R(D,sideParams)}else{B(x,D,sideParams,L)}}if(E){var P=F(N,C,A,O,M);if(alpha<=90){s.border=R(P,borderParams)}else{if(alpha>=180){P=F(h.cx-h.R1,h.cy,A,O,0);s.border=R(P,borderParams);E=false}else{B(S,P,borderParams,L)}}}}topPath=I(N,C,A,O,M);B(T,topPath,topParams,L);d[L]=s}H(x,"side1");H(S,"border");H(T,"top")}var U=c.rect(0,0,i,o);var z=h.backgroundFill[0]==h.backgroundFill[1]?{stroke:"none",fill:h.backgroundFill[0]}:{stroke:"none",gradient:"90-"+h.backgroundFill[0]+"-"+h.backgroundFill[1]};U.attr(z);U.toBack();if(h.animation&&h.numberOfValues>1){for(var L=0;L<h.numberOfValues;L++){d[L].top.num=L;d[L].top.mouseover(function(){if(h.tooltip)W(this.num,true);X(d[this.num]);$(d[this.num],1e3)}).mouseout(function(){if(h.tooltip)W(this.num,false);V(d[this.num]);J(d[this.num],500)})}}if(h.explode&&!h.animation){for(var L=0;L<h.numberOfValues;L++){Q(d[L])}}};Raphael.fn.bar=function(i,s,o,u){function E(e,t,n,r){return["M",e,t,"L",e+f.size3d,t-f.size3d,"L",e+n+f.size3d,t-f.size3d,"L",e+n,t,"z"].join(",")}function S(e,t,n,r){return["M",e+n+f.size3d,t-f.size3d,"L",e+n+f.size3d,t+r-f.size3d,"L",e+n,t+r,"L",e+n,t,"z"].join(",")}function x(e,t){var n=a.path(e);n.attr(t)}function T(e){e.attr("gradient",m+"-"+f.darkColors[e.num]+"-"+f.lightColors[e.num])}function N(e){e.attr("gradient",m+"-"+f.darkColors[e.num]+"-"+f.colors[e.num])}function C(n,r){var i=document.getElementById("tooltip");if(r){b=l[n];lbl=f.labels[n]?f.labels[n]+" - ":"";lbl=lbl+f.val[n];i.style.borderColor=f.colors[n];i.innerHTML=lbl;cur=e(a.canvas);wh=t(i);var s=yt=0;if(f.horizontal){s=cur.left+b.attr("x")+f.size3d/2+b.attr("width");yt=cur.top+b.attr("y")+b.attr("height")/2-wh.height/2}else{s=cur.left+b.attr("x")+f.size3d/2+b.attr("width")/2-wh.width/2;yt=cur.top+b.attr("y")-f.size3d/2-wh.height}i.style.left=s+"px";i.style.top=yt+"px";i.style.display="block"}else{i.style.display="none"}}function M(){Raphael.getColor.reset();for(var e=0;e<f.numberOfValues;e++){if(f.val[e]>f.max){f.max=f.val[e]}f.colors[e]===undefined?f.colors[e]=Raphael.getColor():false;f.darkColors[e]=n(f.colors[e]);f.lightColors[e]=r(f.colors[e])}}var a=this;u=u||{};var f={val:o,numberOfValues:o.length,max:0,colors:u.colors||[],darkColors:[],lightColors:[],show3d:u.show3d||false,size3d:u.size3d||-1,horizontal:u.horizontal||false,tooltip:u.tooltip||false,labels:u.labels||[],backgroundFill:u.backgroundFill||["#fff","#fff"]};var l=[];M();var c=5;var p=0;var d=0;var v=y=w=h=0;var m=180;if(f.horizontal){m=90;p=(s-c*2)/f.numberOfValues;if(f.size3d==-1)f.size3d=p/4;d=i-f.size3d-c*3;y=c+f.size3d;v=c;h=p/1.5}else{p=(i-c*2)/f.numberOfValues;if(f.size3d==-1)f.size3d=p/4;d=s-f.size3d-c*2;v=c;w=p/1.5}for(var g=0;g<f.numberOfValues;g++){topParams={stroke:"#000","stroke-width":.5,fill:f.colors[g]};sideParams={stroke:"#000","stroke-width":.5,fill:f.darkColors[g]};frontParams={stroke:"#000","stroke-width":.5,gradient:m+"-"+f.darkColors[g]+"-"+f.colors[g]};if(f.horizontal){w=d/f.max*f.val[g]}else{h=d/f.max*f.val[g];y=c+d-h+f.size3d}frontPart=a.rect(v,y,w,h);frontPart.attr(frontParams);l[g]=frontPart;l[g].num=g;if(f.tooltip){l[g].mouseover(function(){T(this);C(this.num,true)}).mouseout(function(){N(this);C(this.num,false)})}if(f.show3d){topPath=E(v,y,w,h);x(topPath,topParams);sidePath=S(v,y,w,h);x(sidePath,sideParams)}f.horizontal?y+=p:v+=p}if(f.backgroundFill[0]!=f.backgroundFill[1]){attrGrid={stroke:"none",gradient:"45-"+f.backgroundFill[0]+"-"+f.backgroundFill[1]};p3=["M",0,c+f.size3d,"L",c+f.size3d,0,"L",c+f.size3d,s-f.size3d-c,"L",0,s,"z"].join(",");var k=a.path(p3);k.attr(attrGrid);k.toBack();p3=["M",c+f.size3d,0,"L",i,0,"L",i,s-f.size3d-c,"L",c+f.size3d,s-f.size3d-c,"z"].join(",");var L=a.path(p3);L.attr(attrGrid);L.toBack();p3=["M",c+f.size3d,s-f.size3d-c,"L",i,s-f.size3d-c,"L",i-c-f.size3d-1,s,"L",0,s,"z"].join(",");var A=a.path(p3);A.attr(attrGrid);A.toBack()}else{var O=a.rect(0,0,i,s);O.attr({stroke:"none",fill:f.backgroundFill[0]});O.toBack()}}})()
